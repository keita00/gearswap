[FULL functions.lua content goes here]